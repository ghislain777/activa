(this["webpackJsonpmatx-react-pro"]=this["webpackJsonpmatx-react-pro"]||[]).push([[54],{2336:function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return c})),a.d(t,"c",(function(){return m})),a.d(t,"d",(function(){return p}));var r=a(8),n=a.n(r),i=a(18),o=a(20);function l(e,t,a,r){return s.apply(this,arguments)}function s(){return(s=Object(i.a)(n.a.mark((function e(t,a,r,i){var l;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t+=1,e.next=3,o.b.get("/roles?itemsPerPage="+a+"&page="+t+"&id="+r);case 3:return l=e.sent,e.abrupt("return",l.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function c(e){return u.apply(this,arguments)}function u(){return(u=Object(i.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.b.post("/roles",t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return d.apply(this,arguments)}function d(){return(d=Object(i.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.b.put("/roles/"+t.id,t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return v.apply(this,arguments)}function v(){return(v=Object(i.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.b.delete("/roles/"+t.id,{method:"DELETE",herdears:{Accept:"application/json"},data:t.id});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},3166:function(e,t,a){"use strict";a.r(t);var r=a(6),n=a(12),i=a(0),o=a.n(i),l=a(228),s=a.n(l),c=a(231),u=a(766),m=a(224),d=a(606),p=a(64),v=a(1241),b=a(144),h=a(1201),g=a(79),E=a(229),f=a(45),j=a(1204),y=a(1203),O=a(1202),w=a(783),C=a(145),P=a(73),S=a(84),k=a(32),x=a(117),R=a(131),D=a(367),M=(a(368),a(2336)),L=a(60),N=a(266),Q=a(20),q=a(1196);const B=g.b().shape({nom:g.c().required("Le champs Nom est requis"),prenom:g.c().required("Le champs Pr\xe9nom est requis"),civilite:g.c().required("Le champs civilite est requis"),telephone:g.c().required("Le champs T\xe9l\xe9phone est requis"),login:g.c().required("Le champs login est requis"),role:g.c().required("Le champs Role est requis")});function U({id:e,leutilisateur:t,handleFermeture:a,action:l}){var s,c,u,v;const g=Object(k.useQueryClient)(),U=Object(k.useMutation)(C.a,{onSuccess:()=>{g.invalidateQueries("Utilisateurs"),W({message:"Enregistrement r\xe9ussi",open:!0,severity:"success",automaticClose:!0})},onError:()=>{g.invalidateQueries("Utilisateurs"),W({message:"Echec lors de l op\xe9ration",open:!0,severity:"error",automaticClose:!0})}}),T=Object(k.useMutation)(C.e,{onSuccess:()=>{g.invalidateQueries("Utilisateurs"),W({message:"Mise \xe0 jour r\xe9ussie",open:!0,severity:"success",automaticClose:!0})},onError:()=>{g.invalidateQueries("Utilisateurs"),W({message:"Echec lors de la mise \xe0 jour",open:!0,severity:"error",automaticClose:!0})}}),A=Object(k.useQuery)(["Roles",1],()=>Object(M.b)(0,100,"",""),{keepPreviousData:!0}),F=A.isLoading,z=(A.isFetching,A.isError,A.error,A.data),I=Object(i.useState)(t),J=Object(n.a)(I,2),G=J[0],V=J[1],Y=Object(i.useState)({severity:"severity",message:"",open:!1,automaticClose:!0}),H=Object(n.a)(Y,2),K=H[0],W=H[1],X=Object(P.c)({resolver:Object(E.yupResolver)(B),defaultValues:Object(r.a)(Object(r.a)({},G),{},{actif:null!==(s=null===G||void 0===G?void 0:G.actif)&&void 0!==s&&s,role:t?"/api/roles/"+t.role.id:"/api/roles/1"})}),Z=X.control,$=X.handleSubmit,_=X.errors,ee=(X.reset,e=>{let t=Object(r.a)(Object(r.a)({},G),e);G?T.mutate(Object(r.a)({},t)):U.mutate(Object(r.a)({},t))});function te(){a()}return o.a.createElement("div",null,o.a.createElement(S.a,{message:K.message,severity:K.severity,open:K.open,handleAlertClose:K.automaticClose?a:()=>W(Object(r.a)(Object(r.a)({},K),{},{open:!1}))}),o.a.createElement(f.a,{container:!0,spacing:1,justify:"center"},o.a.createElement(f.a,{item:!0,lg:6,md:6,sm:12,xs:12,justify:"center"},o.a.createElement(q.a,{theme:Object(Q.a)()},o.a.createElement(h.a,null,o.a.createElement(j.a,{action:o.a.createElement(m.a,{"aria-label":"",onClick:te},"x"),title:"ajout"===l?"Nouvel utilisateur":"Mise \xe0 jour de l'utilisateur",subheader:""}),o.a.createElement(y.a,{className:" px-6 pt-6 pb-6"}," ",o.a.createElement("form",{onSubmit:$(ee)},o.a.createElement(f.a,{container:!0,spacing:4,direction:"column"},o.a.createElement(f.a,{item:!0},F?o.a.createElement(L.a,{message:"chargement"}):o.a.createElement(R.a,{id:"role",name:"role",label:"Choisir un Role",table:"role",control:Z,options:z["hydra:member"],error:_.role,valeur:null!==(c=null===G||void 0===G?void 0:G.role)&&void 0!==c?c:""})),o.a.createElement(f.a,{item:!0},o.a.createElement(N.a,{displayEmpty:!0,id:"civilite",label:"Civilit\xe9",nom:"civilite",liste:[{id:1,label:"M.",value:"M."},{id:2,label:"Mme",value:"Mme"},{id:3,label:"Mlle",value:"Mlle"}],control:Z,valeur:null!==(u=null===G||void 0===G?void 0:G.civilite)&&void 0!==u?u:" ",error:_.civilite})),o.a.createElement(f.a,{item:!0},o.a.createElement(x.a,{id:"nom",nom:"nom",label:"Nom",valeur:null===G||void 0===G?void 0:G.nom,control:Z,error:_.nom})),o.a.createElement(f.a,{item:!0},o.a.createElement(x.a,{id:"prenom",nom:"prenom",label:"Pr\xe9nom",valeur:null===G||void 0===G?void 0:G.prenom,control:Z,error:_.prenom})),o.a.createElement(f.a,{item:!0},o.a.createElement(x.a,{id:"telephone",nom:"telephone",label:"T\xe9l\xe9phone",valeur:null===G||void 0===G?void 0:G.telephone,control:Z,error:_.telephone})),o.a.createElement(f.a,{item:!0},o.a.createElement(x.a,{id:"email",nom:"email",label:"Email",valeur:null===G||void 0===G?void 0:G.email,control:Z,error:_.email})),o.a.createElement(f.a,{item:!0},o.a.createElement(x.a,{id:"login",nom:"login",label:"login",valeur:null===G||void 0===G?void 0:G.login,control:Z,error:_.login})),o.a.createElement(f.a,{item:!0},o.a.createElement(D.a,{id:"actif",nom:"actif",control:Z,coche:Boolean(null!==(v=null===G||void 0===G?void 0:G.actif)&&void 0!==v?v:""),onChange:e=>{V(Object(r.a)(Object(r.a)({},G),{},{actif:e}))}}))))),o.a.createElement(O.a,null,o.a.createElement(f.a,{container:!0,alignItems:"center",justify:"space-between"},o.a.createElement(f.a,{item:!0},o.a.createElement(b.a,{color:"primary",variant:"contained",type:"submit",onClick:$(ee)},T.isLoading||U.isLoading?o.a.createElement(w.a,{color:"inherit"}):o.a.createElement(d.a,null,"send"),o.a.createElement("span",{className:"pl-2 capitalize"},"ajout"===l?o.a.createElement(p.a,null,"Enregistrer"):o.a.createElement(p.a,null,"Mettre \xe0 jour")))),o.a.createElement(f.a,{item:!0},o.a.createElement(b.a,{variant:"outlined",color:"secondary",onClick:te},"Annuler")))))))))}var T=a(204),A=a(230),F=a(300);a(443);t.default=()=>{const e=Object(i.useState)({page:0,rowsPerPage:10,recherche:"",filtre:""}),t=Object(n.a)(e,2),a=t[0],l=t[1],g=Object(k.useQueryClient)(),E=Object(k.useQuery)(["Utilisateurs",a.page,a.rowsPerPage,a.recherche,a.filtre],()=>Object(C.c)(a.page,a.rowsPerPage,a.recherche,a.filtre),{keepPreviousData:!0}),f=E.isLoading,j=(E.isFetching,E.isError),y=E.error,O=E.data,w=Object(k.useMutation)(C.g,{onSuccess:()=>{Y({message:"op\xe9ration r\xe9ussie r\xe9ussi",open:!0,severity:"success"})},onError:()=>{Y({message:"Echec lors de l op\xe9ration",open:!0,severity:"error"})},onSettled:()=>{g.invalidateQueries("Utilisateurs")}}),P=Object(k.useMutation)(C.f,{onSuccess:()=>{Y({message:"Suppr\xe9ssion r\xe9ussi",open:!0,severity:"success"})},onError:()=>{Y({message:"Echec lors de l op\xe9ration",open:!0,severity:"error"})},onSettled:()=>{g.invalidateQueries("Utilisateurs")}}),x=Object(i.useState)(null),R=Object(n.a)(x,2),D=R[0],M=R[1],N=Object(i.useState)({mode:"affichage",action:"ajout",affichageTable:!0}),B=Object(n.a)(N,2),z=B[0],I=B[1],J=Object(i.useState)({severity:"severity",message:"",open:!1,handleCloseAlert:()=>te()}),G=Object(n.a)(J,2),V=G[0],Y=G[1],H=Object(i.useState)("Liste des utilisateurs."),K=Object(n.a)(H,2),W=K[0],X=K[1],Z=Object(i.useState)(!1),$=Object(n.a)(Z,2),_=$[0],ee=$[1],te=()=>{Y(Object(r.a)(Object(r.a)({},S.a),{},{open:!1}))},ae=[{name:"id",label:"ID",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e}},{name:"civilite",label:"civilite",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e}},{name:"nom",label:"Nom",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e}},{name:"prenom",label:"Pr\xe9nom",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e}},{name:"telephone",label:"T\xe9l\xe9phone",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e}},{name:"email",label:"Email",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e}},{name:"actif",label:"Actif",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>o.a.createElement(u.a,{checked:e,onChange:()=>(e=>{w.mutate(e)})({id:t.rowData[0]})})}},{name:"login",label:"login",options:{filter:!1,sort:!1,display:!1,customBodyRender:(e,t,a)=>e}},{name:"role",label:"Role",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>{var r;return null!==(r=null===e||void 0===e?void 0:e.nom)&&void 0!==r?r:""}}},{name:"action",label:"Actions",options:{filter:!1,sort:!1,customBodyRender:(e,t,a)=>o.a.createElement("div",null,o.a.createElement(m.a,{size:"small",onClick:()=>{(e=>{I({mode:"edition",action:"misajour",affichageTable:!1}),M(e),X("Mise \xe0 jour de l'utilisateur")})({id:t.rowData[0],civilite:t.rowData[1],nom:t.rowData[2],prenom:t.rowData[3],telephone:t.rowData[4],email:t.rowData[5],actif:t.rowData[6],login:t.rowData[7],role:t.rowData[8]})}},o.a.createElement(d.a,{color:"primary"},"edit")))}}];return o.a.createElement("div",{className:"m-sm-30"},o.a.createElement(S.a,{message:V.message,severity:V.severity,open:V.open,handleAlertClose:te}),o.a.createElement("div",{className:"mb-sm-30"},o.a.createElement(T.a,{routeSegments:[{name:"Gestion des utilisateurs"}]})),o.a.createElement("div",{className:"mb-sm-30"},o.a.createElement(p.a,{variant:"h4"},W)),"affichage"===z.mode?o.a.createElement(v.a,{in:z.affichageTable,direction:"right",unmountOnExit:!0},o.a.createElement("div",null,o.a.createElement(b.a,{className:"mb-4",variant:"contained",color:"primary",onClick:()=>(I({mode:"edition",action:"ajout",affichageTable:!1}),M(null),void X("Nouvel utilisateur"))},"Nouvel utilisateur"),f?o.a.createElement(L.a,{message:"Chargement des donn\xe9es",type:"info"}):j?o.a.createElement(L.a,{message:"Erreur lors du chargement des donn\xe9es::"+y,type:"error"}):o.a.createElement(F.a,{tag:"div",blocking:!1},o.a.createElement(q.a,{theme:Object(Q.a)()},o.a.createElement(s.a,{title:W,data:O["hydra:member"],columns:ae,options:Object(r.a)(Object(r.a)({},c.a),{},{serverSide:!0,count:O["hydra:totalItems"],rowsPerPageOptions:[3,5,10],rowsPerPage:a.rowsPerPage,onChangePage:e=>(e=>{l(Object(r.a)(Object(r.a)({},a),{},{page:e})),g.invalidateQueries("Utilisateurs")})(e),onChangeRowsPerPage:e=>(e=>{l(Object(r.a)(Object(r.a)({},a),{},{rowsPerPage:e})),console.log("idbre de ligne par page:"+e),g.invalidateQueries("Utilisateurs")})(e),onSearchChange:e=>(e=>{var t;l(Object(r.a)(Object(r.a)({},a),{},{recherche:null!==e&&void 0!==e?e:""})),console.log(null!==(t="texte a chercher"+e)&&void 0!==t?t:""),g.invalidateQueries("Utilisateurs")})(e),onFilterChange:()=>{console.log("le filtre a chang\xe9")}})}))),o.a.createElement(h.a,{className:"w-full overflow-auto",elevation:8},o.a.createElement(A.a,{open:_,onConfirmDialogClose:()=>{ee(!1)},onYesClick:()=>{ee(!1),P.mutate(D)},text:"Confirmez la suppression de "+(null===D||void 0===D?void 0:D.name)})))):o.a.createElement(U,{action:z.action,leutilisateur:D,handleFermeture:()=>{I({mode:"affichage",action:"nouveau",affichageTable:!0}),X("Liste des utilisateurs")}}))}}}]);