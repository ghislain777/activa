(this["webpackJsonpmatx-react-pro"]=this["webpackJsonpmatx-react-pro"]||[]).push([[51],{2336:function(e,a,t){"use strict";t.d(a,"b",(function(){return s})),t.d(a,"a",(function(){return l})),t.d(a,"c",(function(){return m})),t.d(a,"d",(function(){return p}));var r=t(8),n=t.n(r),o=t(18),i=t(20);function s(e,a,t,r){return c.apply(this,arguments)}function c(){return(c=Object(o.a)(n.a.mark((function e(a,t,r,o){var s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a+=1,e.next=3,i.b.get("/roles?itemsPerPage="+t+"&page="+a+"&id="+r);case 3:return s=e.sent,e.abrupt("return",s.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e){return u.apply(this,arguments)}function u(){return(u=Object(o.a)(n.a.mark((function e(a){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.b.post("/roles",a);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return d.apply(this,arguments)}function d(){return(d=Object(o.a)(n.a.mark((function e(a){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.b.put("/roles/"+a.id,a);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return b.apply(this,arguments)}function b(){return(b=Object(o.a)(n.a.mark((function e(a){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.b.delete("/roles/"+a.id,{method:"DELETE",herdears:{Accept:"application/json"},data:a.id});case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},3167:function(e,a,t){"use strict";t.r(a);var r=t(6),n=t(12),o=t(26),i=t(0),s=t.n(i),c=t(228),l=t.n(c),u=t(231),m=t(224),d=t(606),p=t(64),b=t(1241),v=t(144),g=t(1201),f=(t(95),t(79)),h=t(229),j=t(45),E=t(1204),O=t(1203),y=t(1202),w=t(783),C=t(2336),P=t(73),x=t(84),S=t(32),k=t(117),R=(t(131),t(367),t(368),t(60)),N=(t(266),t(444),t(20)),D=t(1196);const Q=f.b().shape({nom:f.c().required("Le champs Nom est requis"),description:f.c().required("Le champs Description est requis")});function L({id:e,lerole:a,handleFermeture:t,action:o}){var c,l,u;const b=Object(S.useQueryClient)(),f=Object(S.useMutation)(C.a,{onSuccess:()=>{b.invalidateQueries("Roles"),q({message:"Enregistrement r\xe9ussi",open:!0,severity:"success",automaticClose:!0})},onError:()=>{b.invalidateQueries("Roles"),q({message:"Echec lors de l op\xe9ration",open:!0,severity:"error",automaticClose:!0})}}),R=Object(S.useMutation)(C.c,{onSuccess:()=>{b.invalidateQueries("Roles"),q({message:"Mise \xe0 jour r\xe9ussie",open:!0,severity:"success",automaticClose:!0})},onError:()=>{b.invalidateQueries("Roles"),q({message:"Echec lors de la mise \xe0 jour",open:!0,severity:"error",automaticClose:!0})}}),L=Object(i.useState)(a),M=Object(n.a)(L,2),A=M[0],I=(M[1],Object(i.useState)({severity:"severity",message:"",open:!1,automaticClose:!0})),T=Object(n.a)(I,2),z=T[0],q=T[1],B=Object(P.c)({resolver:Object(h.yupResolver)(Q),defaultValues:Object(r.a)(Object(r.a)({},a),{},{id:null!==(c=null===a||void 0===a?void 0:a.id)&&void 0!==c?c:"",nom:null!==(l=null===a||void 0===a?void 0:a.nom)&&void 0!==l?l:"",description:null!==(u=null===a||void 0===a?void 0:a.description)&&void 0!==u?u:""})}),F=B.control,J=B.handleSubmit,_=B.errors,G=(B.reset,e=>{let a=Object(r.a)(Object(r.a)({},A),e);A?R.mutate(Object(r.a)({},a)):f.mutate(Object(r.a)({},a))});function V(){t()}return s.a.createElement("div",null,s.a.createElement(x.a,{message:z.message,severity:z.severity,open:z.open,handleAlertClose:z.automaticClose?t:()=>q(Object(r.a)(Object(r.a)({},z),{},{open:!1}))}),s.a.createElement(j.a,{container:!0,spacing:1,justify:"center"},s.a.createElement(j.a,{item:!0,lg:6,md:6,sm:12,xs:12,justify:"center"},s.a.createElement(D.a,{theme:Object(N.a)()},s.a.createElement(g.a,null,s.a.createElement(E.a,{action:s.a.createElement(m.a,{"aria-label":"",onClick:V},"x"),title:"ajout"===o?"Nouveau role":"Mise \xe0 jour de role",subheader:""}),s.a.createElement(O.a,{className:" px-6 pt-6 pb-6"}," ",s.a.createElement("form",{onSubmit:J(G)},s.a.createElement(j.a,{container:!0,spacing:4,direction:"column"},s.a.createElement(j.a,{item:!0},s.a.createElement(k.a,{id:"nom",nom:"nom",label:"Nom",valeur:null===A||void 0===A?void 0:A.nom,control:F,error:_.nom})),s.a.createElement(j.a,{item:!0},s.a.createElement(k.a,{id:"description",nom:"description",label:"Description",valeur:null===A||void 0===A?void 0:A.description,control:F,error:_.description}))))),s.a.createElement(y.a,null,s.a.createElement(j.a,{container:!0,alignItems:"center",justify:"space-between"},s.a.createElement(j.a,{item:!0},s.a.createElement(v.a,{color:"primary",variant:"contained",type:"submit",onClick:J(G)},R.isLoading||f.isLoading?s.a.createElement(w.a,{color:"inherit"}):s.a.createElement(d.a,null,"send"),s.a.createElement("span",{className:"pl-2 capitalize"},"ajout"===o?s.a.createElement(p.a,null,"Enregistrer"):s.a.createElement(p.a,null,"Mettre \xe0 jour")))),s.a.createElement(j.a,{item:!0},s.a.createElement(v.a,{variant:"outlined",color:"secondary",onClick:V},"Annuler")))))))))}var M=t(204),A=t(230),I=t(300),T=(t(443),t(3),t(110));Object(T.a)(e=>{e.palette,Object(o.a)(e,["palette"]);return{userMenu:{display:"flex",alignItems:"center",cursor:"pointer",borderRadius:24,padding:4,"& span":{margin:"0 8px"}},menuItem:{display:"flex",alignItems:"center",minWidth:185}}});a.default=()=>{const e=Object(i.useState)({page:0,rowsPerPage:20,recherche:"",filtre:""}),a=Object(n.a)(e,2),t=a[0],o=a[1],c=Object(S.useQueryClient)(),f=Object(S.useQuery)(["Roles",t.page,t.rowsPerPage,t.recherche,t.filtre],()=>Object(C.b)(t.page,t.rowsPerPage,t.recherche,t.filtre),{keepPreviousData:!0}),h=f.isLoading,j=(f.isFetching,f.isError),E=f.error,O=f.data,y=Object(S.useMutation)(C.d,{onSuccess:()=>{G({message:"Suppr\xe9ssion r\xe9ussi",open:!0,severity:"success"})},onError:()=>{G({message:"Echec lors de l op\xe9ration",open:!0,severity:"error"})},onSettled:()=>{c.invalidateQueries("Roles")}}),w=Object(i.useState)(null),P=Object(n.a)(w,2),k=P[0],Q=P[1],T=Object(i.useState)({mode:"affichage",action:"ajout",affichageTable:!0}),z=Object(n.a)(T,2),q=z[0],B=z[1],F=Object(i.useState)({severity:"severity",message:"",open:!1,handleCloseAlert:()=>$()}),J=Object(n.a)(F,2),_=J[0],G=J[1],V=Object(i.useState)("Liste des roles"),W=Object(n.a)(V,2),Y=W[0],H=W[1],K=Object(i.useState)(!1),U=Object(n.a)(K,2),X=U[0],Z=U[1],$=()=>{G(Object(r.a)(Object(r.a)({},x.a),{},{open:!1}))},ee=[{name:"id",label:"ID",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>e}},{name:"nom",label:"Nom",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>e}},{name:"description",label:"Description",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>e}},{name:"action",label:"Actions",options:{filter:!1,sort:!1,customBodyRender:(e,a,t)=>s.a.createElement("div",null,s.a.createElement(m.a,{size:"small",onClick:()=>{(e=>{B({mode:"edition",action:"misajour",affichageTable:!1}),Q(e),H("Mise \xe0 jour de role")})({id:a.rowData[0],nom:a.rowData[1],description:a.rowData[2]})}},s.a.createElement(d.a,{color:"primary"},"edit")),s.a.createElement(m.a,{size:"small",onClick:()=>(e=>{Z(!0),Q(e)})({id:a.rowData[0]})},s.a.createElement(d.a,{color:"error"},"delete")),s.a.createElement(m.a,{size:"small",onClick:()=>(a.rowData[0],void console.log("affichage de details"))},s.a.createElement(d.a,null,"arrow_right_alt")))}}];return s.a.createElement("div",{className:"m-sm-30"},s.a.createElement(x.a,{message:_.message,severity:_.severity,open:_.open,handleAlertClose:$}),s.a.createElement("div",{className:"mb-sm-30"},s.a.createElement(M.a,{routeSegments:[{name:"Gestiion des roles"}]})),s.a.createElement("div",{className:"mb-sm-30"},s.a.createElement(p.a,{variant:"h4"},Y)),"affichage"===q.mode?s.a.createElement(b.a,{in:q.affichageTable,direction:"right",unmountOnExit:!0},s.a.createElement("div",null,s.a.createElement(v.a,{className:"mb-4",variant:"contained",color:"primary",onClick:()=>(B({mode:"edition",action:"ajout",affichageTable:!1}),Q(null),void H("Nouveau r\xf4le"))},"Nouveau r\xf4le"),h?s.a.createElement(R.a,{message:"Chargement des donn\xe9es",type:"info"}):j?s.a.createElement(R.a,{message:"Erreur lors du chargement des donn\xe9es::"+E,type:"error"}):s.a.createElement(I.a,{tag:"div",blocking:!1},s.a.createElement(D.a,{theme:Object(N.a)()},s.a.createElement(l.a,{title:Y,data:O["hydra:member"],columns:ee,options:Object(r.a)(Object(r.a)({},u.a),{},{serverSide:!0,count:O["hydra:totalItems"],rowsPerPageOptions:[20,30,50],rowsPerPage:t.rowsPerPage,onChangePage:e=>(e=>{o(Object(r.a)(Object(r.a)({},t),{},{page:e})),c.invalidateQueries("Roles")})(e),onChangeRowsPerPage:e=>(e=>{o(Object(r.a)(Object(r.a)({},t),{},{rowsPerPage:e})),console.log("idbre de ligne par page:"+e),c.invalidateQueries("Roles")})(e),onSearchChange:e=>(e=>{var a;o(Object(r.a)(Object(r.a)({},t),{},{recherche:null!==e&&void 0!==e?e:""})),console.log(null!==(a="texte a chercher"+e)&&void 0!==a?a:""),c.invalidateQueries("Roles")})(e),onFilterChange:()=>{console.log("le filtre a chang\xe9")}})}))),s.a.createElement(g.a,{className:"w-full overflow-auto",elevation:8},s.a.createElement(A.a,{open:X,onConfirmDialogClose:()=>{Z(!1)},onYesClick:()=>{Z(!1),y.mutate(k)},text:"Confirmez la suppression de "+(null===k||void 0===k?void 0:k.name)})))):s.a.createElement(L,{action:q.action,lerole:k,handleFermeture:()=>{B({mode:"affichage",action:"nouveau",affichageTable:!0}),H("Liste des roles")}}))}}}]);