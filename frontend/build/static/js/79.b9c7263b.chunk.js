(this["webpackJsonpmatx-react-pro"]=this["webpackJsonpmatx-react-pro"]||[]).push([[79],{2397:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return m})),a.d(t,"d",(function(){return d}));var r=a(8),n=a.n(r),c=a(18),s=a(20);function i(e,t,a,r){return o.apply(this,arguments)}function o(){return(o=Object(c.a)(n.a.mark((function e(t,a,r,c){var i;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t+=1,e.next=3,s.b.get("/typevehicules?itemsPerPage="+a+"&page="+t+"&nom="+r);case 3:return i=e.sent,e.abrupt("return",i.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e){return u.apply(this,arguments)}function u(){return(u=Object(c.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.b.post("/typevehicules",t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return p.apply(this,arguments)}function p(){return(p=Object(c.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.b.put("/typevehicules/"+t.id,t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return h.apply(this,arguments)}function h(){return(h=Object(c.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.b.delete("/typevehicules/"+t.id,{method:"DELETE",herdears:{Accept:"application/json"},data:t.id});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},3177:function(e,t,a){"use strict";a.r(t);var r=a(6),n=a(12),c=a(0),s=a.n(c),i=a(228),o=a.n(i),l=a(231),u=a(2302),m=a(224),p=a(606),d=a(64),h=a(1241),v=a(144),b=a(1201),y=a(45),g=a(79),f=a(229),j=a(783),E=a(2397),O=a(73),C=a(84),w=a(32),P=a(117),S=(a(131),a(367),a(368)),T=a(369),x=a(60);const k=g.b().shape({nom:g.c().required("Le champs Nom est requis"),description:g.c().required("Le champs Description est requis")});function N({id:e,letypevehicule:t,handleFermeture:a,action:i}){const o=Object(w.useQueryClient)(),l=Object(w.useMutation)(E.a,{onSuccess:()=>{o.invalidateQueries("Typevehicules"),Q({message:"Enregistrement r\xe9ussi",open:!0,severity:"success",automaticClose:!0})},onError:()=>{o.invalidateQueries("Typevehicules"),Q({message:"Echec lors de l op\xe9ration",open:!0,severity:"error",automaticClose:!0})}}),u=Object(w.useMutation)(E.c,{onSuccess:()=>{o.invalidateQueries("Typevehicules"),Q({message:"Mise \xe0 jour r\xe9ussie",open:!0,severity:"success",automaticClose:!0})},onError:()=>{o.invalidateQueries("Typevehicules"),Q({message:"Echec lors de la mise \xe0 jour",open:!0,severity:"error",automaticClose:!0})}}),m=Object(w.useMutation)(T.a,{onSuccess:()=>{Q(Object(r.a)(Object(r.a)({},D),{},{automaticClose:!1,message:"Fichier charg\xe9 sur le serveur",open:!0,severity:"success"}))},onError:()=>{Q(Object(r.a)(Object(r.a)({},D),{},{automaticClose:!1,message:"Echec de chargement du fichier sur le serveur",open:!0,severity:"error"}))}}),h=Object(c.useState)(t),b=Object(n.a)(h,2),g=b[0],x=(b[1],Object(c.useState)({severity:"severity",message:"",open:!1,automaticClose:!0})),N=Object(n.a)(x,2),D=N[0],Q=N[1],L=Object(O.c)({resolver:Object(f.yupResolver)(k),defaultValues:Object(r.a)({},g)}),M=L.control,R=L.handleSubmit,A=L.errors,B=(L.reset,e=>{let t=Object(r.a)(Object(r.a)(Object(r.a)({},g),e),{},{photo:m.data});g?u.mutate(Object(r.a)({},t)):l.mutate(Object(r.a)({},t))});return s.a.createElement("div",null,s.a.createElement(C.a,{message:D.message,severity:D.severity,open:D.open,handleAlertClose:D.automaticClose?a:()=>Q(Object(r.a)(Object(r.a)({},D),{},{open:!1}))}),s.a.createElement("form",{onSubmit:R(B)},s.a.createElement(y.a,{container:!0,spacing:4,direction:"column"},s.a.createElement(y.a,{item:!0},s.a.createElement(S.a,{onUpload:e=>{var t;(t=e)&&m.mutate({fichier:t,objet:"typevehicule"})},onSupprimer:()=>{alert("suppression du fichier"+g.photo)}})),s.a.createElement(y.a,{item:!0},s.a.createElement(P.a,{id:"nom",nom:"nom",label:"Nom",valeur:null===g||void 0===g?void 0:g.nom,control:M,error:A.nom})),s.a.createElement(y.a,{item:!0},s.a.createElement(P.a,{id:"description",nom:"description",label:"Description",valeur:null===g||void 0===g?void 0:g.description,control:M,error:A.description})),s.a.createElement(y.a,{item:!0},s.a.createElement(y.a,{container:!0,alignItems:"center",justify:"space-between"},s.a.createElement(y.a,{item:!0},s.a.createElement(v.a,{color:"primary",variant:"contained",type:"submit",onClick:R(B)},u.isLoading||l.isLoading?s.a.createElement(j.a,{color:"inherit"}):s.a.createElement(p.a,null,"send"),s.a.createElement("span",{className:"pl-2 capitalize"},"ajout"===i?s.a.createElement(d.a,null,"Enregistrer"):s.a.createElement(d.a,null,"Mettre \xe0 jour")))),s.a.createElement(y.a,{item:!0},s.a.createElement(v.a,{variant:"outlined",color:"secondary",onClick:function(){a()}},"Annuler")))))))}var D=a(204),Q=a(230),L=a(300),M=(a(443),a(20));t.default=()=>{const e=Object(c.useState)({page:0,rowsPerPage:20,recherche:"",filtre:""}),t=Object(n.a)(e,2),a=t[0],i=t[1],g=Object(w.useQueryClient)(),f=Object(w.useQuery)(["Typevehicules",a.page,a.rowsPerPage,a.recherche,a.filtre],()=>Object(E.b)(a.page,a.rowsPerPage,a.recherche,a.filtre),{keepPreviousData:!0}),j=f.isLoading,O=(f.isFetching,f.isError),P=f.error,S=f.data,T=Object(w.useMutation)(E.d,{onSuccess:()=>{Y({message:"Suppr\xe9ssion r\xe9ussi",open:!0,severity:"success"})},onError:()=>{Y({message:"Echec lors de l op\xe9ration",open:!0,severity:"error"})},onSettled:()=>{g.invalidateQueries("Typevehicules")}}),k=Object(c.useState)(null),R=Object(n.a)(k,2),A=R[0],B=R[1],F=Object(c.useState)({mode:"affichage",action:"ajout",affichageTable:!0}),q=Object(n.a)(F,2),z=q[0],I=q[1],J=Object(c.useState)({severity:"severity",message:"",open:!1,handleCloseAlert:()=>ee()}),U=Object(n.a)(J,2),V=U[0],Y=U[1],G=Object(c.useState)("Liste des typevehicules"),H=Object(n.a)(G,2),K=H[0],W=H[1],X=Object(c.useState)(!1),Z=Object(n.a)(X,2),$=Z[0],_=Z[1],ee=()=>{Y(Object(r.a)(Object(r.a)({},C.a),{},{open:!1}))},te=[{name:"id",label:"ID",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e}},{name:"nom",label:"Nom",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e}},{name:"description",label:"Description",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e}},{name:"photo",label:"Photo",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>s.a.createElement(u.a,{variant:"rounded",src:M.c+"/fichiers/typevehicule/"+e})}},{name:"action",label:"Actions",options:{filter:!1,sort:!1,customBodyRender:(e,t,a)=>s.a.createElement("div",null,s.a.createElement(m.a,{size:"small",onClick:()=>{(e=>{I({mode:"edition",action:"misajour",affichageTable:!1}),B(e),W("Mise \xe0 jour de typevehicule")})({id:t.rowData[0],nom:t.rowData[1],description:t.rowData[2],photo:t.rowData[3]})}},s.a.createElement(p.a,{color:"primary"},"edit")))}}];return s.a.createElement("div",{className:"m-sm-30"},s.a.createElement(C.a,{message:V.message,severity:V.severity,open:V.open,handleAlertClose:ee}),s.a.createElement("div",{className:"mb-sm-30"},s.a.createElement(D.a,{routeSegments:[{name:"Types de v\xe9hicule"}]})),s.a.createElement("div",{className:"mb-sm-30"},s.a.createElement(d.a,{variant:"h4"},K)),"affichage"===z.mode?s.a.createElement(h.a,{in:z.affichageTable,direction:"right",unmountOnExit:!0},s.a.createElement("div",null,s.a.createElement(v.a,{className:"mb-4",variant:"contained",color:"primary",onClick:()=>(I({mode:"edition",action:"ajout",affichageTable:!1}),B(null),void W("Nouveau type de v\xe9hicule"))},"Nouveau type de v\xe9hicule"),j?s.a.createElement(x.a,{message:"Chargement des donn\xe9es",type:"info"}):O?s.a.createElement(x.a,{message:"Erreur lors du chargement des donn\xe9es::"+P,type:"error"}):s.a.createElement(L.a,{tag:"div",blocking:!1},s.a.createElement(o.a,{title:K,data:S["hydra:member"],columns:te,options:Object(r.a)(Object(r.a)({},l.a),{},{serverSide:!0,count:S["hydra:totalItems"],rowsPerPageOptions:[20,30,50],rowsPerPage:a.rowsPerPage,onChangePage:e=>(e=>{i(Object(r.a)(Object(r.a)({},a),{},{page:e})),g.invalidateQueries("Typevehicules")})(e),onChangeRowsPerPage:e=>(e=>{i(Object(r.a)(Object(r.a)({},a),{},{rowsPerPage:e})),console.log("nombre de ligne par page:"+e),g.invalidateQueries("Typevehicules")})(e),onSearchChange:e=>(e=>{var t;i(Object(r.a)(Object(r.a)({},a),{},{recherche:null!==e&&void 0!==e?e:""})),console.log(null!==(t="texte a chercher"+e)&&void 0!==t?t:""),g.invalidateQueries("Typevehicules")})(e),onFilterChange:()=>{console.log("le filtre a chang\xe9")}})})),s.a.createElement(b.a,{className:"w-full overflow-auto",elevation:8},s.a.createElement(Q.a,{open:$,onConfirmDialogClose:()=>{_(!1)},onYesClick:()=>{_(!1),T.mutate(A)},text:"Confirmez la suppression de "+(null===A||void 0===A?void 0:A.name)})))):s.a.createElement(y.a,{container:!0,spacing:6,alignContent:"center",justify:"center"},s.a.createElement(y.a,{item:!0,lg:6,md:6,sm:12,xs:12},s.a.createElement(b.a,{className:"px-6 pt-2 pb-4"},s.a.createElement(N,{action:z.action,letypevehicule:A,handleFermeture:()=>{I({mode:"affichage",action:"nouveau",affichageTable:!0}),W("Liste des typevehicules")}})))))}}}]);