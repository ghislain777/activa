(this["webpackJsonpmatx-react-pro"]=this["webpackJsonpmatx-react-pro"]||[]).push([[46],{2401:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return m})),a.d(t,"d",(function(){return d}));var r=a(8),n=a.n(r),s=a(18),o=a(20);function i(e,t,a,r){return c.apply(this,arguments)}function c(){return(c=Object(s.a)(n.a.mark((function e(t,a,r,s){var i;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t+=1,e.next=3,o.b.get("/villes?itemsPerPage="+a+"&page="+t+"&nom="+r);case 3:return i=e.sent,e.abrupt("return",i.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e){return u.apply(this,arguments)}function u(){return(u=Object(s.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.b.post("/villes",t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return p.apply(this,arguments)}function p(){return(p=Object(s.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.b.put("/villes/"+t.id,t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return b.apply(this,arguments)}function b(){return(b=Object(s.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.b.delete("/villes/"+t.id,{method:"DELETE",herdears:{Accept:"application/json"},data:t.id});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},2402:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return m})),a.d(t,"d",(function(){return d}));var r=a(8),n=a.n(r),s=a(18),o=a(20);function i(e,t,a,r){return c.apply(this,arguments)}function c(){return(c=Object(s.a)(n.a.mark((function e(t,a,r,s){var i;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t+=1,e.next=3,o.b.get("/communes?itemsPerPage="+a+"&page="+t+"&nom="+r);case 3:return i=e.sent,e.abrupt("return",i.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e){return u.apply(this,arguments)}function u(){return(u=Object(s.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.b.post("/communes",t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return p.apply(this,arguments)}function p(){return(p=Object(s.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.b.put("/communes/"+t.id,t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return b.apply(this,arguments)}function b(){return(b=Object(s.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.b.delete("/communes/"+t.id,{method:"DELETE",herdears:{Accept:"application/json"},data:t.id});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},3175:function(e,t,a){"use strict";a.r(t);var r=a(6),n=a(12),s=a(0),o=a.n(s),i=a(228),c=a.n(i),l=a(231),u=a(224),m=a(606),p=a(64),d=a(1241),b=a(144),v=a(1201),f=a(45),h=a(79),g=a(229),j=a(783),E=a(2402),y=a(73),O=a(84),C=a(32),w=a(117),x=a(131),P=(a(367),a(368),a(369),a(2401)),k=a(60);const S=h.b().shape({ville:h.c().required("Le champs ID est requis"),nom:h.c().required("Le champs Nom est requis"),description:h.c().required("Le champs Description est requis")});function D({id:e,lecommune:t,handleFermeture:a,action:i}){var c;const l=Object(C.useQueryClient)(),u=Object(C.useMutation)(E.a,{onSuccess:()=>{l.invalidateQueries("Communes"),q({message:"Enregistrement r\xe9ussi",open:!0,severity:"success",automaticClose:!0})},onError:()=>{l.invalidateQueries("Communes"),q({message:"Echec lors de l op\xe9ration",open:!0,severity:"error",automaticClose:!0})}}),d=Object(C.useMutation)(E.c,{onSuccess:()=>{l.invalidateQueries("Communes"),q({message:"Mise \xe0 jour r\xe9ussie",open:!0,severity:"success",automaticClose:!0})},onError:()=>{l.invalidateQueries("Communes"),q({message:"Echec lors de la mise \xe0 jour",open:!0,severity:"error",automaticClose:!0})}}),v=Object(C.useQuery)(["Villes",1],()=>Object(P.b)(0,100,"",""),{keepPreviousData:!0}),h=v.isLoading,D=(v.isFetching,v.isError,v.error,v.data),L=Object(s.useState)(t),Q=Object(n.a)(L,2),N=Q[0],A=(Q[1],Object(s.useState)({severity:"severity",message:"",open:!1,automaticClose:!0})),R=Object(n.a)(A,2),T=R[0],q=R[1],M=Object(y.c)({resolver:Object(g.yupResolver)(S),defaultValues:{ville:t?"/api/villes/"+t.ville.id:"/api/villes/1"}}),B=M.control,F=M.handleSubmit,I=M.errors,z=(M.reset,e=>{let t=Object(r.a)(Object(r.a)({},N),e);N?d.mutate(Object(r.a)({},t)):u.mutate(Object(r.a)({},t))});return o.a.createElement("div",null,o.a.createElement(O.a,{message:T.message,severity:T.severity,open:T.open,handleAlertClose:T.automaticClose?a:()=>q(Object(r.a)(Object(r.a)({},T),{},{open:!1}))}),o.a.createElement("form",{onSubmit:F(z)},o.a.createElement(f.a,{container:!0,spacing:4,direction:"column"},o.a.createElement(f.a,{item:!0},h?o.a.createElement(k.a,{message:"chargement des villes"}):o.a.createElement(x.a,{id:"ville",name:"ville",label:"Choisir une ville",table:"ville",control:B,options:D["hydra:member"],error:I.ville,valeur:null!==(c=null===N||void 0===N?void 0:N.ville)&&void 0!==c?c:""})),o.a.createElement(f.a,{item:!0},o.a.createElement(w.a,{id:"nom",nom:"nom",label:"Nom",valeur:null===N||void 0===N?void 0:N.nom,control:B,error:I.nom})),o.a.createElement(f.a,{item:!0},o.a.createElement(w.a,{id:"description",nom:"description",label:"Description",valeur:null===N||void 0===N?void 0:N.description,control:B,error:I.description})),o.a.createElement(f.a,{item:!0},o.a.createElement(f.a,{container:!0,alignItems:"center",justify:"space-between"},o.a.createElement(f.a,{item:!0},o.a.createElement(b.a,{color:"primary",variant:"contained",type:"submit",onClick:F(z)},d.isLoading||u.isLoading?o.a.createElement(j.a,{color:"inherit"}):o.a.createElement(m.a,null,"send"),o.a.createElement("span",{className:"pl-2 capitalize"},"ajout"===i?o.a.createElement(p.a,null,"Enregistrer"):o.a.createElement(p.a,null,"Mettre \xe0 jour")))),o.a.createElement(f.a,{item:!0},o.a.createElement(b.a,{variant:"outlined",color:"secondary",onClick:function(){a()}},"Annuler")))))))}var L=a(204),Q=a(230),N=a(300);a(443);t.default=()=>{const e=Object(s.useState)({page:0,rowsPerPage:20,recherche:"",filtre:""}),t=Object(n.a)(e,2),a=t[0],i=t[1],h=Object(C.useQueryClient)(),g=Object(C.useQuery)(["Communes",a.page,a.rowsPerPage,a.recherche,a.filtre],()=>Object(E.b)(a.page,a.rowsPerPage,a.recherche,a.filtre),{keepPreviousData:!0}),j=g.isLoading,y=(g.isFetching,g.isError),w=g.error,x=g.data,P=Object(C.useMutation)(E.d,{onSuccess:()=>{J({message:"Suppr\xe9ssion r\xe9ussi",open:!0,severity:"success"})},onError:()=>{J({message:"Echec lors de l op\xe9ration",open:!0,severity:"error"})},onSettled:()=>{h.invalidateQueries("Communes")}}),S=Object(s.useState)(null),A=Object(n.a)(S,2),R=A[0],T=A[1],q=Object(s.useState)({mode:"affichage",action:"ajout",affichageTable:!0}),M=Object(n.a)(q,2),B=M[0],F=M[1],I=Object(s.useState)({severity:"severity",message:"",open:!1,handleCloseAlert:()=>$()}),z=Object(n.a)(I,2),V=z[0],J=z[1],Y=Object(s.useState)("Liste des communes"),G=Object(n.a)(Y,2),H=G[0],K=G[1],U=Object(s.useState)(!1),W=Object(n.a)(U,2),X=W[0],Z=W[1],$=()=>{J(Object(r.a)(Object(r.a)({},O.a),{},{open:!1}))},_=[{name:"id",label:"ID",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e}},{name:"nom",label:"Commune",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e}},{name:"ville",label:"Ville",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e.nom}},{name:"description",label:"Description",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e}},{name:"action",label:"Actions",options:{filter:!1,sort:!1,customBodyRender:(e,t,a)=>o.a.createElement("div",null,o.a.createElement(u.a,{size:"small",onClick:()=>{(e=>{F({mode:"edition",action:"misajour",affichageTable:!1}),T(e),K("Mise \xe0 jour de commune")})({id:t.rowData[0],ville:t.rowData[2],nom:t.rowData[1],description:t.rowData[3]})}},o.a.createElement(m.a,{color:"primary"},"edit")))}}];return o.a.createElement("div",{className:"m-sm-30"},o.a.createElement(O.a,{message:V.message,severity:V.severity,open:V.open,handleAlertClose:$}),o.a.createElement("div",{className:"mb-sm-30"},o.a.createElement(L.a,{routeSegments:[{name:"Liste des communes"}]})),o.a.createElement("div",{className:"mb-sm-30"},o.a.createElement(p.a,{variant:"h4"},H)),"affichage"===B.mode?o.a.createElement(d.a,{in:B.affichageTable,direction:"right",unmountOnExit:!0},o.a.createElement("div",null,o.a.createElement(b.a,{className:"mb-4",variant:"contained",color:"primary",onClick:()=>(F({mode:"edition",action:"ajout",affichageTable:!1}),T(null),void K("Nouvelle Commune"))},"Nouvelle Commune"),j?o.a.createElement(k.a,{message:"Chargement des donn\xe9es",type:"info"}):y?o.a.createElement(k.a,{message:"Erreur lors du chargement des donn\xe9es::"+w,type:"error"}):o.a.createElement(N.a,{tag:"div",blocking:!1},o.a.createElement(c.a,{title:H,data:x["hydra:member"],columns:_,options:Object(r.a)(Object(r.a)({},l.a),{},{serverSide:!0,count:x["hydra:totalItems"],rowsPerPageOptions:[20,30,50],rowsPerPage:a.rowsPerPage,onChangePage:e=>(e=>{i(Object(r.a)(Object(r.a)({},a),{},{page:e})),h.invalidateQueries("Communes")})(e),onChangeRowsPerPage:e=>(e=>{i(Object(r.a)(Object(r.a)({},a),{},{rowsPerPage:e})),console.log("nombre de ligne par page:"+e),h.invalidateQueries("Communes")})(e),onSearchChange:e=>(e=>{var t;i(Object(r.a)(Object(r.a)({},a),{},{recherche:null!==e&&void 0!==e?e:""})),console.log(null!==(t="texte a chercher"+e)&&void 0!==t?t:""),h.invalidateQueries("Communes")})(e),onFilterChange:()=>{console.log("le filtre a chang\xe9")}})})),o.a.createElement(v.a,{className:"w-full overflow-auto",elevation:8},o.a.createElement(Q.a,{open:X,onConfirmDialogClose:()=>{Z(!1)},onYesClick:()=>{Z(!1),P.mutate(R)},text:"Confirmez la suppression de "+(null===R||void 0===R?void 0:R.name)})))):o.a.createElement(f.a,{container:!0,spacing:6,alignContent:"center",justify:"center"},o.a.createElement(f.a,{item:!0,lg:6,md:6,sm:12,xs:12},o.a.createElement(v.a,{className:"px-6 pt-2 pb-4"},o.a.createElement(D,{action:B.action,lecommune:R,handleFermeture:()=>{F({mode:"affichage",action:"nouveau",affichageTable:!0}),K("Liste des communes")}})))))}}}]);