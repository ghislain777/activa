(this["webpackJsonpmatx-react-pro"]=this["webpackJsonpmatx-react-pro"]||[]).push([[72],{3184:function(e,t,a){"use strict";a.r(t);var r=a(3),o=a(12),n=a(0),i=a.n(n),l=a(1177),s=a(17),c=a(135),p=a.n(c),u=a(100),m=a(1222),d=a(2292),b=a(2213),g=a(59),h=a(1262),f=a(450),j=a(64),O=a(142),v=a(136),y=a(33),E=a(150),w=(a(240),a(9)),S=a(449),A=a(1176);var D=e=>{var t,a;const o=e.state,n=e.fonctions,l=e.collonnes,s=e.queries,c=e.useform,D=e.onSubmit;return i.a.createElement("div",{className:"m-sm-30"},i.a.createElement(m.a,{open:o.dialoguephoto.open,"aria-labelledby":"",maxWidth:"md",onClose:n.handleCloseDialoguephoto,objet:o.dialoguephoto.objet},i.a.createElement(d.a,{id:""},o.dialoguephoto.titre),i.a.createElement(b.a,null,i.a.createElement("img",{src:w.e+"/fichiers/"+o.dialoguephoto.objet+"/"+o.dialoguephoto.fichier,alt:"{objet}",srcset:""}))),i.a.createElement(j.a,{message:o.alert.message,severity:o.alert.severity,open:o.alert.open,handleAlertClose:!0===o.alert.automaticClose?()=>n.handleFermetureAlerte():()=>n.fermerAlerte()}),i.a.createElement("div",{className:"mb-sm-30"},i.a.createElement(O.a,{routeSegments:[{name:o.titre}]})),i.a.createElement("div",{className:"mb-sm-30"},i.a.createElement(g.a,{variant:"h4"},o.titre)),"affichage"===o.pagestate.mode?i.a.createElement(h.a,{in:o.pagestate.affichageTable,direction:"right",unmountOnExit:!0},i.a.createElement("div",null,s.queryAppelsortants.isLoading?i.a.createElement(y.a,{message:"Chargement des donn\xe9es...",type:"info"}):s.queryAppelsortants.isError?i.a.createElement(y.a,{message:"Erreur lors du chargement des donn\xe9es::"+s.queryAppelsortants.error,type:"error"}):i.a.createElement(E.a,{tag:"div",blocking:!1},i.a.createElement(S.a,{theme:Object(w.a)()},i.a.createElement(p.a,{title:o.titre,data:s.queryAppelsortants.data["hydra:member"],columns:l,options:Object(r.a)(Object(r.a)({},u.a),{},{serverSide:!0,count:s.queryAppelsortants.data["hydra:totalItems"],rowsPerPageOptions:[20,30,50],rowsPerPage:o.tableconfig.rowsPerPage,textLabels:Object(r.a)(Object(r.a)({},u.a.textLabels),{},{toolbar:Object(r.a)(Object(r.a)({},u.a.textLabels.toolbar),{},{search:"Rechercher par id"})}),onChangePage:e=>n.handleChangePage(e),onChangeRowsPerPage:e=>n.handleChangeRowPerPage(e),onSearchChange:e=>n.handleSearchChange(e),onFilterChange:()=>n.handleFilterChange()})}))),i.a.createElement(f.a,{className:"w-full overflow-auto",elevation:8},i.a.createElement(v.a,{open:o.dialogueSuppressionOuvert,onConfirmDialogClose:n.fermerDialogueSuppression,onYesClick:n.confirmerSuppression,text:null!==(t="Confirmez la suppression de "+(null===(a=o.appelsortant)||void 0===a?void 0:a.nom))&&void 0!==t?t:""})))):i.a.createElement(A.a,{state:o,fonctions:n,queries:s,useform:c,onSubmit:D}))},P=a(27),C=a(78),q=a(2315),R=a(2316),M=a(2317),k=a(2311),x=a(117),L=a(785),T=a(2222),B=a(97),N=a(587),Q=a(2261),I=a(1217),F=a(2310);Object(x.a)(e=>{e.palette,Object(P.a)(e,["palette"]);return{userMenu:{display:"flex",alignItems:"center",cursor:"pointer",borderRadius:24,padding:4,"& span":{margin:"0 8px"}},menuItem:{display:"flex",alignItems:"center",minWidth:185}}});function V(e){const t=Object(x.a)(e=>{e.palette,Object(P.a)(e,["palette"]);return{userMenu:{display:"flex",alignItems:"center",cursor:"pointer",borderRadius:24,padding:4,"& span":{margin:"0 8px"}},menuItem:{display:"flex",alignItems:"center",minWidth:185}}}),a=(t,a)=>{e.handleClickSurAction(t,a)};return[{name:"id",label:"ID",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>{var r;return null!==(r=null===e||void 0===e?void 0:e.toLocaleString("fr-FR"))&&void 0!==r?r:""}}},{name:"statutentretient",label:"Statut entretient",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>{var r;return null!==(r=null===e||void 0===e?void 0:e.nom)&&void 0!==r?r:" "}}},{name:"produit",label:"produit",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>{var r;return null!==(r=null===e||void 0===e?void 0:e.nom)&&void 0!==r?r:" "}}},{name:"telephone",label:"T\xe9l\xe9phone",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e}},{name:"nometprenom",label:"Nom et pr\xe9nom",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e}},{name:"appele",label:"Appel\xe9?",options:{filter:!1,sort:!1,display:!0,customBodyRender:(t,a,r)=>i.a.createElement(L.a,{checked:t,onChange:()=>e.handleTogleappele({id:a.rowData[0],appele:t})})}},{name:"dateappel",label:"Date Appel",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>null==e?" ":Object(I.a)(Object(F.a)(e),"dd/MM/yyyy HH:mm")}},{name:"montant",label:"Montant",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>{var r;return null!==(r=null===e||void 0===e?void 0:e.toLocaleString("fr-FR"))&&void 0!==r?r:""}}},{name:"verbatimclient",label:"Verbatim client",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>null!==e&&void 0!==e?e:""}},{name:"action",label:"Actions",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,r,o)=>i.a.createElement("div",null,i.a.createElement(C.p,{menuButton:i.a.createElement("div",{className:t.userMenu},i.a.createElement(T.a,{xsDown:!0},i.a.createElement(B.a,{size:"small",variant:"outlined",color:"primary",endIcon:i.a.createElement(k.a,null)},"Actions")))},(e=>{switch(e.statut){case"Annul\xe9":return[{id:1,nom:"D\xe9tails",action:e=>a(e,"D\xe9tails"),icon:i.a.createElement(q.a,{color:"primary"})}];case"Nouveau":return[{id:1,nom:"D\xe9tails",action:e=>a(e,"D\xe9tails"),icon:i.a.createElement(q.a,{color:"primary"})},{id:2,nom:"Modifier",action:e=>a(e,"Modifier"),icon:i.a.createElement(R.a,{color:"primary"})},{id:3,nom:"Supprimer",action:e=>a(e,"Supprimer"),icon:i.a.createElement(M.a,{color:"error"})}];default:return[{id:2,nom:"Modifier",action:e=>a(e,"Modifier"),icon:i.a.createElement(R.a,{color:"primary"})}]}})({id:r.rowData[0],statutentretient:r.rowData[1],produit:r.rowData[2],telephone:r.rowData[3],nometprenom:r.rowData[4],appele:r.rowData[5],dateappel:r.rowData[6],montant:r.rowData[7],verbatimclient:r.rowData[8]}).map(e=>i.a.createElement(i.a.Fragment,null,i.a.createElement(N.a,{onClick:()=>e.action({id:r.rowData[0],statutentretient:r.rowData[1],produit:r.rowData[2],telephone:r.rowData[3],nometprenom:r.rowData[4],appele:r.rowData[5],dateappel:r.rowData[6],montant:r.rowData[7],verbatimclient:r.rowData[8]}),key:e.id,value:e.statut},e.icon,"   ",i.a.createElement("span",{className:"ml-5"},e.nom)),i.a.createElement(Q.a,null)))))}}]}var W=a(36),z=a(57),H=(a(213),a(99)),J=a(853),Y=a(854);t.default=()=>{const e={appelsortant:{statutentretient:"/api/statutentretients/1",produit:"/api/produits/1",telephone:"",nometprenom:"",appele:"",dateappel:"",montant:0,verbatimclient:""},appelsortant1:null,titre:"Appels sortants",tableconfig:{page:0,rowsPerPage:30,recherche:"",filtre:""},pagestate:{mode:"affichage",action:"ajout",affichageTable:!0},alert:{severity:"severity",message:"",open:!1,automaticClose:!1},dialogueSuppressionOuvert:!1,dialoguephoto:{open:!1,fichier:"",titre:"",objet:""}},t=Object(n.useState)(e),a=Object(o.a)(t,2),c=a[0],p=a[1];let u=new l.a,m=new J.a,d=new Y.a;const b=Object(s.useQueryClient)(),g={handleFermetureAlerte:()=>{p(Object(r.a)(Object(r.a)({},c),{},{titre:"Appels sortants",alert:Object(r.a)(Object(r.a)({},c.alert),{},{open:!1}),pagestate:Object(r.a)(Object(r.a)({},c.pagestate),{},{mode:"affichage",affichageTable:!0})}))},handleClicksurNouveau:()=>{p(Object(r.a)(Object(r.a)({},c),{},{appelsortant:null,titre:"Nouvel appel ",pagestate:{mode:"edition",action:"ajout",affichageTable:!1}}))},fermerAlerte:()=>{p(Object(r.a)(Object(r.a)({},c),{},{alert:Object(r.a)(Object(r.a)({},c.alert),{},{open:!1})}))},AnnulerEnregistrement:()=>{console.log("Annulation de l'enregistrement"),p(Object(r.a)(Object(r.a)({},c),{},{titre:"Appels sortants",pagestate:{mode:"affichage",action:"ajout",affichageTable:!0}}))},fermerDialogueSuppression:()=>{p(Object(r.a)(Object(r.a)({},c),{},{dialogueSuppressionOuvert:!1}))},confirmerSuppression:()=>{E.mutate(c.appelsortant)},handleCloseDialoguephoto:()=>{p(Object(r.a)(Object(r.a)({},c),{},{dialoguephoto:Object(r.a)(Object(r.a)({},c.dialoguephoto),{},{open:!1})}))},handleChangeRowPerPage:e=>{p(Object(r.a)(Object(r.a)({},c),{},{tableconfig:Object(r.a)(Object(r.a)({},c.tableconfig),{},{rowsPerPage:e})}))},handleSearchChange:e=>{p(Object(r.a)(Object(r.a)({},c),{},{tableconfig:Object(r.a)(Object(r.a)({},c.tableconfig),{},{recherche:e})}))},handleChangePage:e=>{p(Object(r.a)(Object(r.a)({},c),{},{tableconfig:Object(r.a)(Object(r.a)({},c.tableconfig),{},{page:e})}))},handleClickSurAction:(e,t)=>{switch(console.log(t),t){case"D\xe9tails":console.log("action details");break;case"Modifier":p(Object(r.a)(Object(r.a)({},c),{},{titre:"Mise \xe0 jour ",appelsortant:e,pagestate:{mode:"edition",action:"misajour",affichageTable:!1}}));break;case"Supprimer":p(Object(r.a)(Object(r.a)({},c),{},{appelsortant:e,dialogueSuppressionOuvert:!0}))}},handleTogleappele:e=>{y.mutate(e)},handledatedateappelchange:e=>{p(Object(r.a)(Object(r.a)({},c),{},{appelsortant:Object(r.a)(Object(r.a)({},c.appelsortant),{},{dateappel:e})}))}},h=Object(s.useQuery)(["Appelsortants",c.tableconfig.page,c.tableconfig.rowsPerPage,c.tableconfig.recherche,c.tableconfig.filtre],()=>u.getTouslesAppelsortants(c.tableconfig.page,c.tableconfig.rowsPerPage,c.tableconfig.recherche,c.tableconfig.filtre),{keepPreviousData:!0}),f=Object(s.useQuery)(["Statutentretients",c.tableconfig.page,c.tableconfig.rowsPerPage,c.tableconfig.recherche,c.tableconfig.filtre],()=>m.getTouslesStatutentretients(0,1e3,c.tableconfig.recherche,c.tableconfig.filtre),{keepPreviousData:!0}),j=Object(s.useQuery)(["Produits",c.tableconfig.page,c.tableconfig.rowsPerPage,c.tableconfig.recherche,c.tableconfig.filtre],()=>d.getTouslesProduits(0,1e3,c.tableconfig.recherche,c.tableconfig.filtre),{keepPreviousData:!0}),O=Object(s.useMutation)(u.ajoutAppelsortant,{onSuccess:()=>{b.invalidateQueries("Appelsortants"),p(Object(r.a)(Object(r.a)({},c),{},{alert:{message:"Enregistrement r\xe9ussi",open:!0,severity:"success",automaticClose:!0}}))},onError:()=>{b.invalidateQueries("Appelsortants"),p(Object(r.a)(Object(r.a)({},c),{},{alert:{message:"Echec lors de l'enregistrement",open:!0,severity:"error",automaticClose:!0}}))}}),v=Object(s.useMutation)(u.miseajourAppelsortant,{onSuccess:()=>{b.invalidateQueries("Appelsortants"),p(Object(r.a)(Object(r.a)({},c),{},{alert:{message:"Mise \xe0 jour R\xe9ussie...",open:!0,severity:"success",automaticClose:!0}}))},onError:()=>{b.invalidateQueries("Appelsortants"),p(Object(r.a)(Object(r.a)({},c),{},{alert:{message:"Echec lors de la mise \xe0 jour",open:!0,severity:"error",automaticClose:!0}}))}}),y=Object(s.useMutation)(u.togleappeleAppelsortant,{onSuccess:()=>{p(Object(r.a)(Object(r.a)({},c),{},{alert:{message:"op\xe9ration r\xe9ussie",open:!0,severity:"success"}}))},onError:()=>{p({alert:{message:"Echec lors de l op\xe9ration",open:!0,severity:"error"}})},onSettled:()=>{b.invalidateQueries("Appelsortants")}}),E=Object(s.useMutation)(u.suppressionAppelsortant,{onSuccess:()=>{p(Object(r.a)(Object(r.a)({},c),{},{dialogueSuppressionOuvert:!1,alert:{message:"Supr\xe9ssion r\xe9ussie",open:!0,severity:"success"}}))},onError:()=>{p({alert:{message:"Echec lors de la supr\xe9ssion",open:!0,severity:"error"}})},onSettled:()=>{b.invalidateQueries("Appelsortants")}}),w={queryAppelsortants:h,mutationMiseajour:v,mutationAjout:O,mutationSuppression:E,queryStatutentretients:f,queryProduits:j},S=V(g),A=W.b().shape({statutentretient:W.c().required("Le champs Statutentretient est requis"),produit:W.c().required("Le champs Produit est requis"),telephone:W.c().required("Le champs Telephone est requis"),nometprenom:W.c().required("Le champs Nometprenom est requis"),montant:W.a().required("montant requis").positive("Le montant doit \xeatre positif").integer("Le montant doit \xeatre un nombre entier"),verbatimclient:W.c().required("Le champs Verbatimclient est requis")}),P=Object(z.c)({resolver:Object(H.yupResolver)(A),defaultValues:{appelsortant:c.appelsortant}});return i.a.createElement(D,{state:c,fonctions:g,collonnes:S,queries:w,useform:P,onSubmit:e=>{var t;let a=Object(r.a)(Object(r.a)({},c.appelsortant),e);void 0!==(null===(t=c.appelsortant)||void 0===t?void 0:t.id)?w.mutationMiseajour.mutate(Object(r.a)({},a)):w.mutationAjout.mutate(Object(r.a)({},a))}})}}}]);