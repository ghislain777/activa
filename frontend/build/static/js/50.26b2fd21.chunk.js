(this["webpackJsonpmatx-react-pro"]=this["webpackJsonpmatx-react-pro"]||[]).push([[50],{2336:function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return p})),a.d(t,"d",(function(){return d}));var r=a(8),n=a.n(r),i=a(18),s=a(20);function c(e,t,a,r){return o.apply(this,arguments)}function o(){return(o=Object(i.a)(n.a.mark((function e(t,a,r,i){var c;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t+=1,e.next=3,s.b.get("/roles?itemsPerPage="+a+"&page="+t+"&id="+r);case 3:return c=e.sent,e.abrupt("return",c.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e){return u.apply(this,arguments)}function u(){return(u=Object(i.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.b.post("/roles",t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return m.apply(this,arguments)}function m(){return(m=Object(i.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.b.put("/roles/"+t.id,t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return v.apply(this,arguments)}function v(){return(v=Object(i.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.b.delete("/roles/"+t.id,{method:"DELETE",herdears:{Accept:"application/json"},data:t.id});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},3150:function(e,t,a){"use strict";a.r(t);var r=a(6),n=a(12),i=a(0),s=a.n(i),c=a(228),o=a.n(c),l=a(231),u=a(766),p=a(64),m=a(45),d=a(1201),v=a(262),b=a(434),g=a(568),f=a(1241),h=a(79),E=a(229),y=a(144),j=a(783),O=a(606),P=a(8),w=a.n(P),x=a(18),C=a(20);function S(){return(S=Object(x.a)(w.a.mark((function e(t,a,r,n,i){var s;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t+=1,e.next=3,C.b.get("/privileges?itemsPerPage="+a+"&page="+t+"&id="+r+"&role="+i);case 3:return s=e.sent,e.abrupt("return",s.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e){return Q.apply(this,arguments)}function Q(){return(Q=Object(x.a)(w.a.mark((function e(t){var a;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.b.post("/privileges",t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e){return L.apply(this,arguments)}function L(){return(L=Object(x.a)(w.a.mark((function e(t){var a;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.b.put("/privileges/"+t.id,t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e){return D.apply(this,arguments)}function D(){return(D=Object(x.a)(w.a.mark((function e(t){var a;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.b.put("/privileges/togle/"+t.id,t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e){return B.apply(this,arguments)}function B(){return(B=Object(x.a)(w.a.mark((function e(t){var a;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.b.delete("/privileges/"+t.id,{method:"DELETE",herdears:{Accept:"application/json"},data:t.id});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var N=a(73),M=a(84),F=a(32),T=a(117),I=(a(131),a(367)),z=(a(368),a(369),a(60));const J=h.b().shape({activite:h.c().required("Le champs Activit\ufffd est requis"),role:h.c().required("Le champs Role est requis"),actif:h.c().required("Le champs Actif? est requis"),description:h.c().required("Le champs Description est requis")});function G({id:e,leprivilege:t,handleFermeture:a,action:c}){var o;const l=Object(F.useQueryClient)(),u=Object(F.useMutation)(k,{onSuccess:()=>{l.invalidateQueries("Privileges"),x({message:"Enregistrement r\xe9ussi",open:!0,severity:"success",automaticClose:!0})},onError:()=>{l.invalidateQueries("Privileges"),x({message:"Echec lors de l op\xe9ration",open:!0,severity:"error",automaticClose:!0})}}),d=Object(F.useMutation)(R,{onSuccess:()=>{l.invalidateQueries("Privileges"),x({message:"Mise \xe0 jour r\xe9ussie",open:!0,severity:"success",automaticClose:!0})},onError:()=>{l.invalidateQueries("Privileges"),x({message:"Echec lors de la mise \xe0 jour",open:!0,severity:"error",automaticClose:!0})}}),v=Object(i.useState)(t),b=Object(n.a)(v,2),g=b[0],f=b[1],h=Object(i.useState)({severity:"severity",message:"",open:!1,automaticClose:!0}),P=Object(n.a)(h,2),w=P[0],x=P[1],C=Object(N.c)({resolver:Object(E.yupResolver)(J)}),S=C.control,Q=C.handleSubmit,L=C.errors,A=(C.reset,e=>{let t=Object(r.a)(Object(r.a)({},g),e);g?d.mutate(Object(r.a)({},t)):u.mutate(Object(r.a)({},t))});return s.a.createElement("div",null,s.a.createElement(M.a,{message:w.message,severity:w.severity,open:w.open,handleAlertClose:w.automaticClose?a:()=>x(Object(r.a)(Object(r.a)({},w),{},{open:!1}))}),s.a.createElement("form",{onSubmit:Q(A)},s.a.createElement(m.a,{container:!0,spacing:4,direction:"column"},s.a.createElement(m.a,{item:!0},s.a.createElement(T.a,{id:"activite",nom:"activite",label:"Activit\ufffd",valeur:null===g||void 0===g?void 0:g.activite,control:S,error:L.activite})),s.a.createElement(m.a,{item:!0},s.a.createElement(T.a,{id:"role",nom:"role",label:"Role",valeur:null===g||void 0===g?void 0:g.role,control:S,error:L.role})),s.a.createElement(m.a,null,s.a.createElement(I.a,{id:"actif",nom:"actif",control:S,coche:Boolean(null!==(o=null===g||void 0===g?void 0:g.actif)&&void 0!==o?o:""),onChange:e=>{f(Object(r.a)(Object(r.a)({},g),{},{actif:e}))}})),s.a.createElement(m.a,{item:!0},s.a.createElement(T.a,{id:"description",nom:"description",label:"Description",valeur:null===g||void 0===g?void 0:g.description,control:S,error:L.description})),s.a.createElement(m.a,{item:!0},s.a.createElement(m.a,{container:!0,alignItems:"center",justify:"space-between"},s.a.createElement(m.a,{item:!0},s.a.createElement(y.a,{color:"primary",variant:"contained",type:"submit",onClick:Q(A)},d.isLoading||u.isLoading?s.a.createElement(j.a,{color:"inherit"}):s.a.createElement(O.a,null,"send"),s.a.createElement("span",{className:"pl-2 capitalize"},"ajout"===c?s.a.createElement(p.a,null,"Enregistrer"):s.a.createElement(p.a,null,"Mettre \xe0 jour")))),s.a.createElement(m.a,{item:!0},s.a.createElement(y.a,{variant:"outlined",color:"secondary",onClick:function(){a()}},"Annuler")))))))}var Y=a(204),H=a(230),K=a(300),U=(a(443),a(2336));t.default=()=>{const e=Object(i.useState)({page:0,rowsPerPage:30,recherche:"",filtre:"",role:""}),t=Object(n.a)(e,2),a=t[0],c=t[1],h=Object(F.useQueryClient)(),E=Object(F.useQuery)(["Privileges",a.page,a.rowsPerPage,a.recherche,a.filtre,a.role],()=>function(e,t,a,r,n){return S.apply(this,arguments)}(a.page,a.rowsPerPage,a.recherche,a.filtre,a.role),{keepPreviousData:!0}),y=E.isLoading,j=(E.isFetching,E.isError),O=E.error,P=E.data,w=Object(F.useMutation)(q,{onSuccess:()=>{V({message:"Suppr\xe9ssion r\xe9ussi",open:!0,severity:"success"})},onError:()=>{V({message:"Echec lors de l op\xe9ration",open:!0,severity:"error"})},onSettled:()=>{h.invalidateQueries("Privileges")}}),x=Object(F.useMutation)(A,{onSuccess:()=>{V({message:"op\xe9ration r\xe9ussie r\xe9ussi",open:!0,severity:"success"})},onError:()=>{V({message:"Echec lors de l op\xe9ration",open:!0,severity:"error"})},onSettled:()=>{h.invalidateQueries("Privileges")}}),C=Object(F.useQuery)(["Roles",1],()=>Object(U.b)(0,100,"",""),{keepPreviousData:!0}),k=Object(i.useState)(null),Q=Object(n.a)(k,2),R=Q[0],L=(Q[1],Object(i.useState)({mode:"affichage",action:"ajout",affichageTable:!0})),D=Object(n.a)(L,2),B=D[0],N=D[1],T=Object(i.useState)({severity:"severity",message:"",open:!1,handleCloseAlert:()=>re()}),I=Object(n.a)(T,2),J=I[0],V=I[1],W=Object(i.useState)("Liste des privileges"),X=Object(n.a)(W,2),Z=X[0],$=X[1],_=Object(i.useState)(!1),ee=Object(n.a)(_,2),te=ee[0],ae=ee[1],re=()=>{V(Object(r.a)(Object(r.a)({},M.a),{},{open:!1}))},ne=[{name:"id",label:"ID",options:{filter:!1,sort:!1,display:!1,customBodyRender:(e,t,a)=>e}},{name:"activite",label:"Menu",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>s.a.createElement("strong",null,e.menu.nom)}},{name:"activite",label:"Activit\xe9",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e.nom}},{name:"activite",label:"description",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e.description}},{name:"role",label:"Role",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e.nom}},{name:"actif",label:"Actif?",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>s.a.createElement(u.a,{checked:e,onChange:()=>(e=>{x.mutate(e)})({id:t.rowData[0]})})}},{name:"description",label:"Description",options:{filter:!1,sort:!1,display:!1,customBodyRender:(e,t,a)=>e}}];return s.a.createElement("div",{className:"m-sm-30"},s.a.createElement(M.a,{message:J.message,severity:J.severity,open:J.open,handleAlertClose:re}),s.a.createElement("div",{className:"mb-sm-30"},s.a.createElement(Y.a,{routeSegments:[{name:"Gestion des privileges"}]})),s.a.createElement("div",{className:"mb-sm-30"},s.a.createElement(p.a,{variant:"h4"},Z)),s.a.createElement(m.a,{container:!0,spacing:3,className:" pt-2 pb-4"},s.a.createElement(m.a,{item:!0,lg:6,md:6,sm:12,xs:12},s.a.createElement(d.a,{className:"px-6 pt-2 pb-4"},s.a.createElement(m.a,{container:!0,spacing:4,direction:"row"},s.a.createElement(m.a,{item:!0},s.a.createElement(p.a,{variant:"h6"},"Filtrer par r\xf4le")),s.a.createElement(m.a,{item:!0},C.isLoading?s.a.createElement(z.a,{message:"chargement des roles"}):s.a.createElement(v.a,null,s.a.createElement(b.a,{variant:"outlined",displayEmpty:!0,id:"role",value:a.role,onChange:e=>{c(Object(r.a)(Object(r.a)({},a),{},{role:e.target.value})),h.invalidateQueries("Privileges")}},s.a.createElement(g.a,{value:""},"Choisir un role pour filtrer"),C.data["hydra:member"].map(e=>s.a.createElement(g.a,{key:e.id,value:e.id},e.nom))))))))),"affichage"===B.mode?s.a.createElement(f.a,{in:B.affichageTable,direction:"right",unmountOnExit:!0},s.a.createElement("div",null,y?s.a.createElement(z.a,{message:"Chargement des donn\xe9es",type:"info"}):j?s.a.createElement(z.a,{message:"Erreur lors du chargement des donn\xe9es::"+O,type:"error"}):s.a.createElement(K.a,{tag:"div",blocking:!1},s.a.createElement(o.a,{title:Z,data:P["hydra:member"],columns:ne,options:Object(r.a)(Object(r.a)({},l.a),{},{serverSide:!0,count:P["hydra:totalItems"],rowsPerPageOptions:[30,40,60],rowsPerPage:a.rowsPerPage,onChangePage:e=>(e=>{c(Object(r.a)(Object(r.a)({},a),{},{page:e})),h.invalidateQueries("Privileges")})(e),onChangeRowsPerPage:e=>(e=>{c(Object(r.a)(Object(r.a)({},a),{},{rowsPerPage:e})),console.log("idbre de ligne par page:"+e),h.invalidateQueries("Privileges")})(e),onSearchChange:e=>(e=>{var t;c(Object(r.a)(Object(r.a)({},a),{},{recherche:null!==e&&void 0!==e?e:""})),console.log(null!==(t="texte a chercher"+e)&&void 0!==t?t:""),h.invalidateQueries("Privileges")})(e),onFilterChange:()=>{console.log("le filtre a chang\xe9")}})})),s.a.createElement(d.a,{className:"w-full overflow-auto",elevation:8},s.a.createElement(H.a,{open:te,onConfirmDialogClose:()=>{ae(!1)},onYesClick:()=>{ae(!1),w.mutate(R)},text:"Confirmez la suppression de "+(null===R||void 0===R?void 0:R.name)})))):s.a.createElement(m.a,{container:!0,spacing:6,alignContent:"center",justify:"center"},s.a.createElement(m.a,{item:!0,lg:6,md:6,sm:12,xs:12},s.a.createElement(d.a,{className:"px-6 pt-2 pb-4"},s.a.createElement(G,{action:B.action,leprivilege:R,handleFermeture:()=>{N({mode:"affichage",action:"nouveau",affichageTable:!0}),$("Liste des privileges")}})))))}}}]);