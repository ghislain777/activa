(this["webpackJsonpmatx-react-pro"]=this["webpackJsonpmatx-react-pro"]||[]).push([[122],{3151:function(e,a,t){"use strict";t.r(a);var r=t(6),n=t(12),s=t(0),c=t.n(s),i=t(228),o=t.n(i),l=t(231),u=t(766),m=t(224),d=t(606),p=t(64),b=t(1241),v=t(144),f=t(1201),g=t(45),y=t(79),h=t(229),E=t(783),j=t(8),O=t.n(j),C=t(18),w=t(20);function P(){return(P=Object(C.a)(O.a.mark((function e(a,t,r,n){var s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a+=1,e.next=3,w.b.get("/typedecaisses?itemsPerPage="+t+"&page="+a+"&nom="+r);case 3:return s=e.sent,e.abrupt("return",s.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){return T.apply(this,arguments)}function T(){return(T=Object(C.a)(O.a.mark((function e(a){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.b.post("/typedecaisses",a);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return k.apply(this,arguments)}function k(){return(k=Object(C.a)(O.a.mark((function e(a){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.b.put("/typedecaisses/"+a.id,a);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e){return D.apply(this,arguments)}function D(){return(D=Object(C.a)(O.a.mark((function e(a){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.b.delete("/typedecaisses/"+a.id,{method:"DELETE",herdears:{Accept:"application/json"},data:a.id});case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Q=t(73),A=t(84),L=t(32),R=t(117),B=(t(131),t(367)),M=(t(368),t(369),t(60));const q=y.b().shape({nom:y.c().required("Le champs Nom est requis"),description:y.c().required("Le champs Description est requis")});function F({id:e,letypedecaisse:a,handleFermeture:t,action:i}){var o,l;const u=Object(L.useQueryClient)(),m=Object(L.useMutation)(S,{onSuccess:()=>{u.invalidateQueries("Typedecaisses"),T({message:"Enregistrement r\xe9ussi",open:!0,severity:"success",automaticClose:!0})},onError:()=>{u.invalidateQueries("Typedecaisses"),T({message:"Echec lors de l op\xe9ration",open:!0,severity:"error",automaticClose:!0})}}),b=Object(L.useMutation)(x,{onSuccess:()=>{u.invalidateQueries("Typedecaisses"),T({message:"Mise \xe0 jour r\xe9ussie",open:!0,severity:"success",automaticClose:!0})},onError:()=>{u.invalidateQueries("Typedecaisses"),T({message:"Echec lors de la mise \xe0 jour",open:!0,severity:"error",automaticClose:!0})}}),f=Object(s.useState)(a),y=Object(n.a)(f,2),j=y[0],O=y[1],C=Object(s.useState)({severity:"severity",message:"",open:!1,automaticClose:!0}),w=Object(n.a)(C,2),P=w[0],T=w[1],k=Object(Q.c)({resolver:Object(h.yupResolver)(q),defaultValues:{actif:null!==(o=null===j||void 0===j?void 0:j.actif)&&void 0!==o&&o}}),N=k.control,D=k.handleSubmit,M=k.errors,F=(k.reset,e=>{let a=Object(r.a)(Object(r.a)({},j),e);j?b.mutate(Object(r.a)({},a)):m.mutate(Object(r.a)({},a))});return c.a.createElement("div",null,c.a.createElement(A.a,{message:P.message,severity:P.severity,open:P.open,handleAlertClose:P.automaticClose?t:()=>T(Object(r.a)(Object(r.a)({},P),{},{open:!1}))}),c.a.createElement("form",{onSubmit:D(F)},c.a.createElement(g.a,{container:!0,spacing:4,direction:"column"},c.a.createElement(g.a,{item:!0},c.a.createElement(R.a,{id:"nom",nom:"nom",label:"Nom",valeur:null===j||void 0===j?void 0:j.nom,control:N,error:M.nom})),c.a.createElement(g.a,{item:!0},c.a.createElement(R.a,{id:"description",nom:"description",label:"Description",valeur:null===j||void 0===j?void 0:j.description,control:N,error:M.description})),c.a.createElement(g.a,null,c.a.createElement(B.a,{id:"actif",nom:"actif",control:N,coche:Boolean(null!==(l=null===j||void 0===j?void 0:j.actif)&&void 0!==l?l:""),onChange:e=>{O(Object(r.a)(Object(r.a)({},j),{},{actif:e}))}})),c.a.createElement(g.a,{item:!0},c.a.createElement(g.a,{container:!0,alignItems:"center",justify:"space-between"},c.a.createElement(g.a,{item:!0},c.a.createElement(v.a,{color:"primary",variant:"contained",type:"submit",onClick:D(F)},b.isLoading||m.isLoading?c.a.createElement(E.a,{color:"inherit"}):c.a.createElement(d.a,null,"send"),c.a.createElement("span",{className:"pl-2 capitalize"},"ajout"===i?c.a.createElement(p.a,null,"Enregistrer"):c.a.createElement(p.a,null,"Mettre \xe0 jour")))),c.a.createElement(g.a,{item:!0},c.a.createElement(v.a,{variant:"outlined",color:"secondary",onClick:function(){t()}},"Annuler")))))))}var z=t(204),I=t(230),J=t(300);t(443);a.default=()=>{const e=Object(s.useState)({page:0,rowsPerPage:20,recherche:"",filtre:""}),a=Object(n.a)(e,2),t=a[0],i=a[1],y=Object(L.useQueryClient)(),h=Object(L.useQuery)(["Typedecaisses",t.page,t.rowsPerPage,t.recherche,t.filtre],()=>function(e,a,t,r){return P.apply(this,arguments)}(t.page,t.rowsPerPage,t.recherche,t.filtre),{keepPreviousData:!0}),E=h.isLoading,j=(h.isFetching,h.isError),O=h.error,C=h.data,w=Object(L.useMutation)(N,{onSuccess:()=>{G({message:"Suppr\xe9ssion r\xe9ussi",open:!0,severity:"success"})},onError:()=>{G({message:"Echec lors de l op\xe9ration",open:!0,severity:"error"})},onSettled:()=>{y.invalidateQueries("Typedecaisses")}}),S=Object(s.useState)(null),T=Object(n.a)(S,2),x=T[0],k=T[1],D=Object(s.useState)({mode:"affichage",action:"ajout",affichageTable:!0}),Q=Object(n.a)(D,2),R=Q[0],B=Q[1],q=Object(s.useState)({severity:"severity",message:"",open:!1,handleCloseAlert:()=>ee()}),V=Object(n.a)(q,2),Y=V[0],G=V[1],H=Object(s.useState)("Types de caisses"),K=Object(n.a)(H,2),U=K[0],W=K[1],X=Object(s.useState)(!1),Z=Object(n.a)(X,2),$=Z[0],_=Z[1],ee=()=>{G(Object(r.a)(Object(r.a)({},A.a),{},{open:!1}))},ae=[{name:"id",label:"ID",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>e}},{name:"nom",label:"Nom",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>e}},{name:"description",label:"Description",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>e}},{name:"actif",label:"Actif",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>c.a.createElement(u.a,{checked:e})}},{name:"action",label:"Actions",options:{filter:!1,sort:!1,customBodyRender:(e,a,t)=>c.a.createElement("div",null,c.a.createElement(m.a,{size:"small",onClick:()=>{(e=>{B({mode:"edition",action:"misajour",affichageTable:!1}),k(e),W("Mise \xe0 jour de typedecaisse")})({id:a.rowData[0],nom:a.rowData[1],description:a.rowData[2],actif:a.rowData[3]})}},c.a.createElement(d.a,{color:"primary"},"edit")))}}];return c.a.createElement("div",{className:"m-sm-30"},c.a.createElement(A.a,{message:Y.message,severity:Y.severity,open:Y.open,handleAlertClose:ee}),c.a.createElement("div",{className:"mb-sm-30"},c.a.createElement(z.a,{routeSegments:[{name:"Types de caisse"}]})),c.a.createElement("div",{className:"mb-sm-30"},c.a.createElement(p.a,{variant:"h4"},U)),"affichage"===R.mode?c.a.createElement(b.a,{in:R.affichageTable,direction:"right",unmountOnExit:!0},c.a.createElement("div",null,c.a.createElement(v.a,{className:"mb-4",variant:"contained",color:"primary",onClick:()=>(B({mode:"edition",action:"ajout",affichageTable:!1}),k(null),void W("Nouveau type de caisse"))},"Nouveau type de caisse"),E?c.a.createElement(M.a,{message:"Chargement des donn\xe9es",type:"info"}):j?c.a.createElement(M.a,{message:"Erreur lors du chargement des donn\xe9es::"+O,type:"error"}):c.a.createElement(J.a,{tag:"div",blocking:!1},c.a.createElement(o.a,{title:U,data:C["hydra:member"],columns:ae,options:Object(r.a)(Object(r.a)({},l.a),{},{serverSide:!0,count:C["hydra:totalItems"],rowsPerPageOptions:[20,30,50],rowsPerPage:t.rowsPerPage,onChangePage:e=>(e=>{i(Object(r.a)(Object(r.a)({},t),{},{page:e})),y.invalidateQueries("Typedecaisses")})(e),onChangeRowsPerPage:e=>(e=>{i(Object(r.a)(Object(r.a)({},t),{},{rowsPerPage:e})),console.log("nombre de ligne par page:"+e),y.invalidateQueries("Typedecaisses")})(e),onSearchChange:e=>(e=>{var a;i(Object(r.a)(Object(r.a)({},t),{},{recherche:null!==e&&void 0!==e?e:""})),console.log(null!==(a="texte a chercher"+e)&&void 0!==a?a:""),y.invalidateQueries("Typedecaisses")})(e),onFilterChange:()=>{console.log("le filtre a chang\xe9")}})})),c.a.createElement(f.a,{className:"w-full overflow-auto",elevation:8},c.a.createElement(I.a,{open:$,onConfirmDialogClose:()=>{_(!1)},onYesClick:()=>{_(!1),w.mutate(x)},text:"Confirmez la suppression de "+(null===x||void 0===x?void 0:x.name)})))):c.a.createElement(g.a,{container:!0,spacing:6,alignContent:"center",justify:"center"},c.a.createElement(g.a,{item:!0,lg:6,md:6,sm:12,xs:12},c.a.createElement(f.a,{className:"px-6 pt-2 pb-4"},c.a.createElement(F,{action:R.action,letypedecaisse:x,handleFermeture:()=>{B({mode:"affichage",action:"nouveau",affichageTable:!0}),W("Liste des typedecaisses")}})))))}}}]);